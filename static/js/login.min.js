function ValidarLogin(){var e=$("#useroclave").val();try{$.ajax({type:"POST",url:"validarlogin/",dataType:"json",data:{username:e,csrfmiddlewaretoken:$("input[name=csrfmiddlewaretoken]").val()},success:function(e){200==e.status?($("#btnenviarolvidoclave").prop("disabled",!1),enviarMsgModaloClave("Confirm the sending of mail with new password to ",e.message)):(enviarMsgModaloClave("Error("+e.status+")",e.message),efectoTemblor($("#ModalOlvidoClave")))},error:function(e,o,a){enviarMsgModaloClave(o)}})}catch(e){enviarMsgModaloClave(e)}}function ConfirmaOlvidoClave(){var e=$("#userlost").val();$.ajax({type:"POST",url:"/usuarios/confirmaolvidoclave/",dataType:"json",data:{username:e,csrfmiddlewaretoken:$("input[name=csrfmiddlewaretoken]").val()},beforeSend:function(){mensajeWorking()},success:function(e){$.LoadingOverlay("hide"),200===e.status?mostrarModalOlvidoClave({mensaje:"New Password Created: "+e.message,botones:["end"]}):mostrarModalOlvidoClave({mensaje:e.message,botones:["send","cancel"],temblar:!0})},error:function(e,o,a){$("#loader-msg-wait").hide();let l=e.responseJSON&&e.responseJSON.message?e.responseJSON.message:a||o;mostrarModalOlvidoClave({mensaje:l,botones:["send","cancel"],temblar:!0})}})}function mostrarModalOlvidoClave(e){$("#ModalOlvidoClave").modal("show"),enviarMsgModaloClave(e.mensaje),$("#btnenviarolvidoclave").toggle(e.botones.includes("send")),$("#btncancelarolvidoclave").toggle(e.botones.includes("cancel")),$("#btnfinolvidoclave").toggle(e.botones.includes("end")),e.temblar&&efectoTemblor($("#ModalOlvidoClave"))}function limpiarMsgModaloClave(){$("#divmsgoclave1").text(""),$("#divmsgoclave2").text(""),$("#divmsgoclave").hide()}function enviarMsgModaloClave(e,o=""){$("#divmsgoclave1").text(e),$("#divmsgoclave2").text(o),$("#divmsgoclave").show()}function limpiarCamposModalLogin(){$("#username").val(""),$("#claveuser").val("")}function EnviarLogin(e,o){try{$.ajax({type:"POST",async:!1,url:"/usuarios/login_general/",dataType:"json",data:{username:e,password:o,csrfmiddlewaretoken:$("input[name=csrfmiddlewaretoken]").val()},beforeSend:function(){$("#cclaveusername").val(e)},success:function(e){200==e.status?($("#LoginModal").hide(),$("#formlogin").attr("action",e.url),$("#formlogin")[0].submit()):201==e.status?($("#strengthMessage").html(""),$("#LoginModal").modal("hide"),$("#ModalcClave").modal({backdrop:"static",keyboard:!1}).modal("show"),$("#btncclavesko").click(function(){$("#ModalcClave").modal("hide"),$("#LoginModal").modal("show")})):(enviarMsgModalLogin(e.message1,e.message2),efectoTemblor($("#LoginModal")))},error:function(e,o,a){enviarMsgModalLogin("Error: ",o)}})}catch(e){enviarMsgModalLogin(e)}}function limpiarMsgModalLogin(){$("#divloginerror1").text(""),$("#divloginerror2").text(""),$("#divloginerror").hide()}function enviarMsgModalLogin(e,o=""){$("#divloginerror1").text(e),$("#divloginerror2").text(o),$("#divloginerror").show()}$(document).ready(function(){$("#btnenviarolvidoclave").click(function(){var e=$("#userlost").val();""==e?(enviarMsgModaloClave("Must Indicate a valid user"),efectoTemblor($("#ModalOlvidoClave"))):ConfirmaOlvidoClave()}),$("#btncancelarolvidoclave").click(function(){$("#ModalOlvidoClave").modal("hide"),$("#LoginModal").modal("show")}),$("#btnfinolvidoclave").click(function(){$("#btnenviarolvidoclave").show(),$("#btncancelarolvidoclave").show(),$("#btnfinolvidoclave").hide(),$("#ModalOlvidoClave").modal("hide"),$("#LoginModal").modal("show")}),$("#lnkolvidoclave").click(function(e){e.preventDefault(),$("#userlost").val(""),$("#btnfinolvidoclave").hide(),limpiarMsgModaloClave(),$("#LoginModal").modal("hide"),$("#ModalOlvidoClave").modal({backdrop:"static",keyboard:!1}).modal("show")}),$("#claveuser").addClass("bi-eye"),$("#togglePassword").click(function(){var e=$("#claveuser"),o=e.attr("type");"password"===o&&(e.attr("type","text"),$(this).find("i").removeClass("bi-eye").addClass("bi-eye-slash"),setTimeout(function(){e.attr("type","password"),$("#togglePassword").find("i").removeClass("bi-eye-slash").addClass("bi-eye")},3e3))}),$("#formlogin").on("submit",function(e){var o=$("#username").val(),a=allTrim($("#claveuser").val());e.preventDefault(),limpiarMsgModalLogin(),""==o?(enviarMsgModalLogin("You must enter a valid User."),efectoTemblor($("#LoginModal"))):""==a?(enviarMsgModalLogin("You must enter a valid Password."),efectoTemblor($("#LoginModal"))):EnviarLogin(o,a)}),$("#LoginModal").modal({backdrop:"static",keyboard:!1}).modal("show")});