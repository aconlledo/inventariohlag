function BloquearInputs(){$(".inputdata").prop("readonly",!0).css("background-color","#F0EAE9"),$(".inputtextarea, .inputselect").prop("disabled",!0).css("background-color","#F0EAE9")}function tipoBlurHandler(){var a=$("#tipo").val();$("#activeidMessage").removeClass(),$("#activeidMessage").html(""),$.ajax({async:!1,type:"POST",dataType:"json",url:"/checklastid/",data:{tipo:a,csrfmiddlewaretoken:$("input[name=csrfmiddlewaretoken]").val()},success:function(a){var e=a.context;200==e.status?$("#newid").val(e.newid):MensajeErrorDesconocido(e.status)}})}function PrepararRegistro(a){try{$.ajax({async:!1,type:"POST",dataType:"json",url:"/leeractivo/",data:{id:a,csrfmiddlewaretoken:$("input[name=csrfmiddlewaretoken]").val()},success:function(a){var e=a.context;if(200==e.status){var t=a.registro;$("#id").val(t.id),$("#tipo").val(t.tipo),$("#newid").val(t.newid),$("#nombre").val(t.nombre),$("#modelo").val(t.modelo),$("#fabricante").val(t.fabricante),$("#sku").val(t.sku),$("#detalle").val(t.detalle),$("#serial").val(t.serial),$("#proveedor").val(t.proveedor),$("#owner").val(t.owner),$("#factura").val(t.factura),$("#fcompra").val(t.fcompra),$("#vcompra").val(t.vcompra),$("#factivacion").val(t.factivacion),$("#accounted").val(t.accounted),$("#vactual").val(t.vactual),$("#building").val(t.building),$("#floor").val(t.floor),$("#zona").val(t.zona),$("#city").val(t.city),$("#country").val(t.country),$("#estado").val(t.estado),$("#festado").val(t.festado),$("#usuarioinv").val(t.usuarioinv),$("#fingreso").val(t.fingreso),$("#fmodifica").val(t.fmodifica)}else mostrarMensaje(e.message,MSG_WARNING)}})}catch(a){MensajeErrorDesconocido(a)}}function CamposValidos(){var a=allTrim($("#newid").val());return""!=a||(mostrarMensaje("Must Indicate Active Identifier!!!",MSG_STOP),!1)}function VerRegistro(a){BloquearInputs(),PrepararRegistro(a),$("#diagedit").dialog({title:"View Asset",buttons:[{text:"Exit",click:function(){$(this).dialog("close")},class:"ui-corner-all",style:"color:Black"}]}),$("#diagedit").dialog("open")}function EditarRegistro(a){$("input").prop("readonly",!1).css("background-color","#FFFFFF"),$("textarea, select").prop("disabled",!1).css("background-color","#FFFFFF"),CampoEnReadOnly("id"),CampoEnReadOnly("tipo"),CampoEnReadOnly("newid"),CampoEnReadOnly("fingreso"),CampoEnReadOnly("fmodifica"),PrepararRegistro(a),$("#diagedit").dialog({title:"Edit Asset",buttons:[{text:"Save",click:function(){CamposValidos()&&($(this).dialog("close"),mensajeWorking(),setTimeout(function(){EnviaPeticionAjax(EDITAR_REG,a)},100))},class:"ui-corner-all",style:"color:Green"},{text:"Exit",click:function(){$(this).dialog("close")},class:"ui-corner-all",style:"color:Black"}]}),$("#diagedit").on("dialogopen",function(){$("#nombre").focus()}),$("#diagedit").dialog("open")}function AgregarRegistro(){var a=$("#fcompra")[0]._flatpickr;a.setDate(new Date,!0);var e=$("#factivacion")[0]._flatpickr;e.setDate(new Date,!0);var t=$("#festado")[0]._flatpickr;t.setDate(new Date,!0),BloquearInputs(),$("#nombre").prop("readonly",!1).css("background-color","#FFFFFF"),$("#tipo").prop("disabled",!1).css("background-color","#FFFFFF"),$("#tipo").prop("selectedIndex",0),$("#id").val(""),$("#newid").val(""),$("#nombre").val(""),$("#modelo").val(""),$("#fabricante").val(""),$("#sku").val(""),$("#detalle").val(""),$("#item").val(""),$("#serial").val(""),$("#proveedor").val(""),$("#owner").val("0"),$("#factura").val(""),$("#vcompra").val(""),$("#accounted").val("1"),$("#vactual").val(""),$("#building").val("1"),$("#floor").val(""),$("#zona").val("1"),$("#city").val("1"),$("#country").val("1"),$("#estado").val("0"),$("#festado").val(fechadehoy()),$("#usuarioinv").val("23"),$("#fingreso").val(""),$("#fmodifica").val(""),$("#diagedit").dialog({title:"Add Asset",buttons:[{text:"Save",click:function(){CamposValidos()&&($(this).dialog("close"),mensajeWorking(),setTimeout(function(){EnviaPeticionAjax(AGREGAR_REG,0)},100))},class:"ui-corner-all",style:"color:Green"},{text:"Exit",click:function(){$(this).dialog("close")},class:"ui-corner-all",style:"color:Black"}]}),$("#diagedit").on("dialogopen",function(){$("#tipo").focus()}),$("#diagedit").dialog("open")}function BorrarRegistro(a){BloquearInputs(),PrepararRegistro(a),$("#diagedit").dialog({title:"Delete Asset",buttons:[{text:"Delete",click:function(){$(this).dialog("close"),confirmarMensaje("Asset wil be Deleted from Data Base.",EnviaPeticionAjax,ELIMINAR_REG,a)},class:"ui-corner-all",style:"color:Red"},{text:"Exit",click:function(){$(this).dialog("close")},class:"ui-corner-all",style:"color:Green"}]}),$("#diagedit").dialog("open")}function EnviaPeticionAjax(a,e){let t=$("#diagedit :input").map(function(){let a=$(this).val();return"string"==typeof a&&(a=a.trim()),{name:this.name||this.id,value:a}}).get();t.push({name:"id",value:e}),t.push({name:"accion",value:a}),t.push({name:"csrfmiddlewaretoken",value:$("input[name=csrfmiddlewaretoken]").val()});try{$.ajax({async:!1,type:"POST",dataType:"html",url:"/modificaractivo/",data:$.param(t),beforeSend:function(){},success:function(a){$.LoadingOverlay("hide"),a?(Crear_DataTable(),mostrarMensaje("Change made successfully",MSG_SUCCESS)):mostrarMensaje("UNKNOWN ERROR<br />Change NOT made",MSG_WARNING)},error:function(a,e,t){$.LoadingOverlay("hide");let o=a.responseJSON&&a.responseJSON.message?a.responseJSON.message:t||e;mostrarMensaje("UNKNOWN ERROR"+o,MSG_WARNING)}})}catch(a){MensajeErrorDesconocido(a)}}function Cargar_Modelos(){var a=$("#fabricante option:selected").val();try{$.ajax({method:"POST",dataType:"html",url:"/tablas/selectmodelos/",data:{fabricante:a,csrfmiddlewaretoken:$("input[name=csrfmiddlewaretoken]").val()},success:function(a){""!=a?($("#divmodelos").html(""),$("#divmodelos").html(a)):mostrarMensaje("UNKNOW ERROR",MSG_WARNING)}})}catch(a){MensajeErrorDesconocido(a)}}function Cargar_Ciudades(a){var e=$("#country option:selected").val();try{$.ajax({method:"POST",dataType:"html",url:"/tablas/selectciudades/",data:{pais:e,csrfmiddlewaretoken:$("input[name=csrfmiddlewaretoken]").val()},success:function(a){""!=a?($("#divciudades").html(""),$("#divciudades").html(a),$("#ciudad").attr({id:"city",name:"city"})):mostrarMensaje("UNKNOWN ERROR<br />Change NOT made",MSG_WARNING)}})}catch(a){MensajeErrorDesconocido(a)}}function Crear_DataTable(){$("#tablaregs").DataTable({destroy:!0,paging:!0,pagingType:"full_numbers",bJQueryUI:!0,iDisplayLength:25,columnDefs:[{orderable:!1,targets:[7]},{searchable:!1,targets:[0,7]}]}),$(".tip").tooltip()}$(document).ready(function(){var a=new LiveValidation("newid");a.add(Validate.Presence);var e=new LiveValidation("nombre");e.add(Validate.Presence),$("#fcompra").flatpickr({enableTime:!1,dateFormat:"d-m-Y",defaultDate:"today",locale:"es"}),$("#factivacion").flatpickr({enableTime:!1,dateFormat:"d-m-Y",defaultDate:"today",locale:"es"}),$("#festado").flatpickr({enableTime:!1,dateFormat:"d-m-Y",defaultDate:"today",locale:"es"}),$("#fabricante").on("change",function(){Cargar_Modelos()}),$("#diagview").dialog({autoOpen:!1,position:{my:"center",at:"center",of:window},height:750,width:1300,resizable:!1,modal:!0,show:{effect:"blind",duration:10},hide:{effect:"blind",duration:5},open:function(){},close:function(){$("#id").val(""),$("#newid").val(""),$("#activeidMessage").removeClass(),$("#activeidMessage").html("")}}),$("#newid").keyup(function(){$("#activeidMessage").removeClass(),$("#activeidMessage").html("")}),$("#country").on("change",function(){CargarCiudades()}),$("#tipo").on("blur",function(){tipoBlurHandler()}),Crear_DataTable()});