function ConfirmaCambioClave(){var a=$("#cclaveusername").val(),e=$("#claveactual").val(),s=$("#nuevaclave").val();try{$.ajax({async:!1,type:"POST",url:"/usuarios/confirmacambioclave/",dataType:"json",data:{username:a,oldpassword:e,newpassword:s,csrfmiddlewaretoken:$("input[name=csrfmiddlewaretoken]").val()},beforeSend:function(){$("#loader-msg-wait").show()},complete:function(){$("#loader-msg-wait").hide()},success:function(a){200==a.status?($("#btncclavesok").hide(),$("#btncclavesko").hide(),$("#btncclavesfin").show(),enviarMsgModalcClave(a.message)):(enviarMsgModalcClave("Error("+a.status+"):",a.message),efectoTemblor($("#ModalcClave")))},error:function(a,e,s){enviarMsgModalcClave("Communication Error: "+a+" "+e+" "+s)}})}catch(a){enviarMsgModalcClave(a)}}function limpiarMsgModalcClave(){$("#divmsgcclave1").text(""),$("#divmsgcclave2").text(""),$("#msgmodalcclave").hide()}function enviarMsgModalcClave(a,e=""){$("#divmsgcclave1").text(a),$("#divmsgcclave2").text(e),$("#msgmodalcclave").show()}function checkStrength(a){var e=0;return $("#strength").val(e),a.length<8?($("#strengthMessage").removeClass(),$("#strengthMessage").addClass("Short"),"New password must have at least 8 Characters."):($("#strengthMessage").removeClass(),$("#strengthMessage").addClass("Good"),a.match(/([a-zA-Z])/)&&a.match(/([0-9])/)&&(e+=1),a.match(/([!,%,&,@,#,$,^,*,?,_,~])/)&&(e+=1),a.match(/(.*[!,%,&,@,#,$,^,*,?,_,~].*[!,%,&,@,#,$,^,*,?,_,~])/)&&(e+=1),$("#strength").val(e),e<1?($("#strengthMessage").removeClass(),$("#strengthMessage").addClass("Weak"),"Invalid password. Numbers and letters must be entered."):e<2?($("#strengthMessage").removeClass(),$("#strengthMessage").addClass("Good"),"New password Invalid."):($("#strengthMessage").removeClass(),$("#strengthMessage").addClass("Strong"),"Password strong and valid."))}$(document).ready(function(){$("#btncclavesfin").hide(),$("#btncclavesfin").click(function(){$("#ModalcClave").modal("hide"),($("#LoginModal").length||$('[name="LoginModal"]').length)&&$("#LoginModal").modal("show")}),$("#claveactual").blur(function(){""==$("#claveactual").val()?(enviarMsgModalcClave("Need Password","You must indicate your current password."),efectoTemblor($("#ModalcClave"))):limpiarMsgModalcClave()}),$("#nuevaclave").blur(function(){""==$("#nuevaclave").val()?(enviarMsgModalcClave("Need Password","You must indicate new password."),efectoTemblor($("#ModalcClave"))):limpiarMsgModalcClave()}),$("#nuevaclave").keyup(function(){$("#strengthMessage").html(checkStrength($("#nuevaclave").val()))}),$("#nuevaclaveconf").blur(function(){$("#nuevaclaveconf").val()!=$("#nuevaclave").val()?(enviarMsgModalcClave("Password","Password don't match."),efectoTemblor($("#ModalcClave"))):limpiarMsgModalcClave()}),$("#btncclavesok").click(function(){var a=$("#claveactual").val(),e=$("#nuevaclave").val(),s=$("#nuevaclaveconf").val(),l=$("#strength").val();""==a?(enviarMsgModalcClave("You must indicate your current password."),efectoTemblor($("#ModalcClave"))):""==e?(enviarMsgModalcClave("You must indicate new password"),efectoTemblor($("#ModalcClave"))):e.length<8?(enviarMsgModalcClave("New password must have at least 8 Characters."),efectoTemblor($("#ModalcClave"))):l<1?(enviarMsgModalcClave("New password is poor."),efectoTemblor($("#ModalcClave"))):""==s?(enviarMsgModalcClave("You must confirm the new password."),efectoTemblor($("#ModalcClave"))):e!=s?(enviarMsgModalcClave("Password don't match"),efectoTemblor($("#ModalcClave"))):ConfirmaCambioClave()}),$("#ModalcClave").on("show.bs.modal",function(){$("#claveactual").val(""),$("#nuevaclave").val(""),$("#nuevaclaveconf").val(""),limpiarMsgModalcClave()}),$("#toggleclaveactual").click(function(){var a=$("#claveactual"),e=a.attr("type");"password"===e&&(a.attr("type","text"),$(this).find("i").removeClass("fa-eye").addClass("fa-eye-slash"),setTimeout(function(){a.attr("type","password"),$("#toggleclaveactual").find("i").removeClass("fa-eye-slash").addClass("fa-eye")},4e3))}),$("#toggleclavenueva").click(function(){var a=$("#nuevaclave"),e=a.attr("type");"password"===e&&(a.attr("type","text"),$(this).find("i").removeClass("fa-eye").addClass("fa-eye-slash"),setTimeout(function(){a.attr("type","password"),$("#toggleclavenueva").find("i").removeClass("fa-eye-slash").addClass("fa-eye")},4e3))})});